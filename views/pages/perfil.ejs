<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= pageTitle %></title>
  <link rel="stylesheet" href="/css/estilos.css">
</head>
<body>
  <!-- Header horizontal (Topo) com logo e menu -->
  <%- include('../components/cabecalho') %>

  <!-- Layout principal -->
  <div class="main-layout">
    <!-- Ãrea central para o conteÃºdo principal -->
    <main class="content-area">
      <!-- 8ï¸âƒ£ Tela de Perfil -->
      <h1 class="page-title">Perfil</h1>

      <!-- Seletor de perÃ­odo financeiro -->
      <div style="display: flex; gap: 15px; margin-bottom: 30px;">
        <button class="btn btn-primary" onclick="filtrarPeriodoFinanceiro('mes')" id="filtroMesPerfil">Este mÃªs</button>
        <button class="btn btn-secondary" onclick="filtrarPeriodoFinanceiro('ultimo')" id="filtroUltimoPerfil">Ãšltimo mÃªs</button>
        <button class="btn btn-secondary" onclick="filtrarPeriodoFinanceiro('trimestre')" id="filtroTrimestre">Ãšltimos 3 meses</button>
        <button class="btn btn-secondary" onclick="abrirRelatorioFinanceiro()">ğŸ“Š RelatÃ³rio</button>
      </div>

      <!-- Campos principais: "A pagar", "A receber", "Saldo" -->
      <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 40px;">
        <div class="summary-card">
          <div class="card-icon" style="background: #ef4444;">ğŸ’¸</div>
          <div class="card-title">A pagar</div>
          <div class="card-value">R$ 12.450</div>
        </div>

        <div class="summary-card">
          <div class="card-icon" style="background: #16a34a;">ğŸ’°</div>
          <div class="card-title">A receber</div>
          <div class="card-value">R$ 28.900</div>
        </div>

        <div class="summary-card">
          <div class="card-icon" style="background: #3b82f6;">ğŸ’³</div>
          <div class="card-title">Saldo</div>
          <div class="card-value">R$ 16.450</div>
        </div>
      </div>

      <!-- Blocos de meios de pagamento -->
      <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 30px; margin-bottom: 40px;">

        <!-- Pagamento via boleto -->
        <div class="content-section">
          <div class="section-header">
            <h3 class="section-title">ğŸ§¾ Pagamento via boleto</h3>
          </div>
          <div class="section-content">
            <div style="display: grid; gap: 15px;">
              <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                <div style="font-weight: bold; color: #333; margin-bottom: 5px;">Banco do Brasil</div>
                <div style="color: #666; font-size: 14px;">AgÃªncia: 1234-5</div>
                <div style="color: #666; font-size: 14px;">Conta: 67890-1</div>
              </div>
              <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                <div style="font-weight: bold; color: #333; margin-bottom: 5px;">ItaÃº</div>
                <div style="color: #666; font-size: 14px;">AgÃªncia: 5678-9</div>
                <div style="color: #666; font-size: 14px;">Conta: 12345-6</div>
              </div>
              <button class="btn btn-primary" onclick="adicionarContaBancaria()" style="width: 100%;">+ Adicionar Conta</button>
            </div>
          </div>
        </div>

        <!-- TransferÃªncia bancÃ¡ria -->
        <div class="content-section">
          <div class="section-header">
            <h3 class="section-title">ğŸ¦ TransferÃªncia bancÃ¡ria</h3>
          </div>
          <div class="section-content">
            <div style="display: grid; gap: 15px;">
              <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                <div style="font-weight: bold; color: #333; margin-bottom: 5px;">PIX</div>
                <div style="color: #666; font-size: 14px;">admin@pcrlabor.com</div>
                <div style="color: #018820; font-size: 12px; font-weight: bold;">âœ… Verificado</div>
              </div>
              <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                <div style="font-weight: bold; color: #333; margin-bottom: 5px;">TED/DOC</div>
                <div style="color: #666; font-size: 14px;">Banco: 001 - Banco do Brasil</div>
                <div style="color: #666; font-size: 14px;">Ag: 1234-5 | CC: 67890-1</div>
              </div>
              <button class="btn btn-primary" onclick="adicionarMetodoTransferencia()" style="width: 100%;">+ Adicionar MÃ©todo</button>
            </div>
          </div>
        </div>

        <!-- Link de pagamento -->
        <div class="content-section">
          <div class="section-header">
            <h3 class="section-title">ğŸ”— Link de pagamento</h3>
          </div>
          <div class="section-content">
            <div style="display: grid; gap: 15px;">
              <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                <div style="font-weight: bold; color: #333; margin-bottom: 5px;">Mercado Pago</div>
                <div style="color: #666; font-size: 14px;">Taxa: 4,99%</div>
                <div style="color: #018820; font-size: 12px; font-weight: bold;">âœ… Ativo</div>
              </div>
              <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                <div style="font-weight: bold; color: #333; margin-bottom: 5px;">PagSeguro</div>
                <div style="color: #666; font-size: 14px;">Taxa: 3,99%</div>
                <div style="color: #f59e0b; font-size: 12px; font-weight: bold;">â³ Pendente</div>
              </div>
              <button class="btn btn-primary" onclick="adicionarLinkPagamento()" style="width: 100%;">+ Novo Link</button>
            </div>
          </div>
        </div>

      </div>

      <!-- InformaÃ§Ãµes do usuÃ¡rio -->
      <div class="content-section">
        <div class="section-header">
          <h3 class="section-title">ğŸ‘¤ InformaÃ§Ãµes Pessoais</h3>
          <button class="btn btn-secondary" onclick="editarInformacoesPessoais()">âœï¸ Editar</button>
        </div>
        <div class="section-content">
          <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 30px;">
            <div>
              <div style="margin-bottom: 20px;">
                <label style="font-size: 14px; color: #666; font-weight: 600;">Nome Completo</label>
                <div style="font-size: 16px; color: #333; font-weight: bold;"><%= usuario.nome %></div>
              </div>
              <div style="margin-bottom: 20px;">
                <label style="font-size: 14px; color: #666; font-weight: 600;">Email</label>
                <div style="font-size: 16px; color: #333;"><%= usuario.email %></div>
              </div>
              <div style="margin-bottom: 20px;">
                <label style="font-size: 14px; color: #666; font-weight: 600;">Telefone</label>
                <div style="font-size: 16px; color: #333;"><%= usuario.telefone || '(11) 99999-9999' %></div>
              </div>
            </div>
            <div>
              <div style="margin-bottom: 20px;">
                <label style="font-size: 14px; color: #666; font-weight: 600;">CPF/CNPJ</label>
                <div style="font-size: 16px; color: #333;"><%= usuario.documento || '123.456.789-00' %></div>
              </div>
              <div style="margin-bottom: 20px;">
                <label style="font-size: 14px; color: #666; font-weight: 600;">Ãšltimo Login</label>
                <div style="font-size: 16px; color: #333;"><%= usuario.ultimoLogin %></div>
              </div>
              <div style="margin-bottom: 20px;">
                <label style="font-size: 14px; color: #666; font-weight: 600;">Status</label>
                <div style="font-size: 16px; color: #16a34a; font-weight: bold;">âœ… Ativo</div>
              </div>
            </div>
          </div>

          <div style="display: flex; gap: 15px; margin-top: 30px; padding-top: 20px; border-top: 1px solid #e0e0e0;">
            <button class="btn btn-primary" onclick="salvarAlteracoes()">ğŸ’¾ Salvar AlteraÃ§Ãµes</button>
            <button class="btn btn-secondary" onclick="alterarSenha()">ğŸ”’ Alterar Senha</button>
            <button class="btn btn-secondary" onclick="baixarDados()">ğŸ“„ Baixar Dados</button>
          </div>
        </div>
      </div>

    </main>

    <!-- Lateral direita com Tarefas, CalendÃ¡rio e Pergunte para IA -->
    <%- include('../components/barraLateral') %>
  </div>

  <script>
    // ===== FUNCIONALIDADES DE PERFIL =====

    // Filtros de perÃ­odo financeiro
    function filtrarPeriodoFinanceiro(periodo) {
      // Atualizar botÃµes visuais
      document.querySelectorAll('[id*="filtro"]').forEach(btn => {
        btn.className = 'btn btn-secondary';
      });

      if (periodo === 'mes') {
        document.getElementById('filtroMesPerfil').className = 'btn btn-primary';
      } else if (periodo === 'ultimo') {
        document.getElementById('filtroUltimoPerfil').className = 'btn btn-primary';
      } else if (periodo === 'trimestre') {
        document.getElementById('filtroTrimestre').className = 'btn btn-primary';
      }

      console.log(`ğŸ’° Filtrando dados financeiros por: ${periodo}`);

      // Simular atualizaÃ§Ã£o dos valores
      const valores = {
        'mes': { pagar: 12450, receber: 28900, saldo: 16450 },
        'ultimo': { pagar: 8200, receber: 22100, saldo: 13900 },
        'trimestre': { pagar: 35600, receber: 78400, saldo: 42800 }
      };

      // Feedback visual
      const toast = document.createElement('div');
      toast.style.cssText = `
        position: fixed;
        top: 100px;
        right: 20px;
        background: #018820;
        color: white;
        padding: 12px 20px;
        border-radius: 8px;
        z-index: 1000;
      `;
      toast.textContent = `âœ… PerÃ­odo atualizado: ${periodo === 'mes' ? 'Este mÃªs' : periodo === 'ultimo' ? 'Ãšltimo mÃªs' : 'Ãšltimos 3 meses'}`;
      document.body.appendChild(toast);
      setTimeout(() => toast.remove(), 3000);
    }

    // RelatÃ³rio financeiro
    function abrirRelatorioFinanceiro() {
      const modal = document.createElement('div');
      modal.id = 'modalRelatorioFinanceiro';
      modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
      `;

      modal.innerHTML = `
        <div style="background: white; border-radius: 12px; padding: 20px; width: 95%; max-width: 500px; max-height: 85vh; overflow-y: auto; margin: 20px;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2 style="margin: 0; color: #333; font-size: 18px;">ğŸ“Š RelatÃ³rio Financeiro</h2>
            <button onclick="fecharRelatorioFinanceiro()" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #666;">&times;</button>
          </div>

          <div style="display: grid; gap: 20px;">

            <!-- Tipo de relatÃ³rio -->
            <div>
              <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">ğŸ“‹ Tipo de RelatÃ³rio</label>
              <select id="tipoRelatorioFinanceiro" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px;">
                <option value="completo">ğŸ“Š RelatÃ³rio Completo</option>
                <option value="receitas">ğŸ’° Apenas Receitas</option>
                <option value="despesas">ğŸ’¸ Apenas Despesas</option>
                <option value="fluxo">ğŸ“ˆ Fluxo de Caixa</option>
                <option value="impostos">ğŸ§¾ RelatÃ³rio de Impostos</option>
              </select>
            </div>

            <!-- PerÃ­odo -->
            <div>
              <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">ğŸ“… PerÃ­odo</label>
              <select id="periodoRelatorioFinanceiro" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px;">
                <option value="mes_atual">Este mÃªs</option>
                <option value="mes_anterior">MÃªs anterior</option>
                <option value="trimestre">Ãšltimo trimestre</option>
                <option value="semestre">Ãšltimo semestre</option>
                <option value="ano">Este ano</option>
                <option value="personalizado">PerÃ­odo personalizado</option>
              </select>
            </div>

            <!-- Formato -->
            <div>
              <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">ğŸ“ Formato</label>
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                <label style="display: flex; align-items: center; gap: 8px; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer;" onclick="selecionarFormatoFinanceiro('excel')">
                  <input type="radio" name="formatoFinanceiro" value="excel" checked style="margin: 0;">
                  <span>ğŸ“Š Excel (.xlsx)</span>
                </label>
                <label style="display: flex; align-items: center; gap: 8px; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer;" onclick="selecionarFormatoFinanceiro('pdf')">
                  <input type="radio" name="formatoFinanceiro" value="pdf" style="margin: 0;">
                  <span>ğŸ“„ PDF</span>
                </label>
              </div>
            </div>

          </div>

          <div style="display: flex; gap: 15px; margin-top: 30px;">
            <button onclick="fecharRelatorioFinanceiro()" style="flex: 1; padding: 12px; background: #6b7280; color: white; border: none; border-radius: 8px; cursor: pointer;">
              Cancelar
            </button>
            <button onclick="gerarRelatorioFinanceiro()" style="flex: 1; padding: 12px; background: #018820; color: white; border: none; border-radius: 8px; cursor: pointer;">
              ğŸ“Š Gerar RelatÃ³rio
            </button>
          </div>
        </div>
      `;

      document.body.appendChild(modal);
    }

    function fecharRelatorioFinanceiro() {
      const modal = document.getElementById('modalRelatorioFinanceiro');
      if (modal) modal.remove();
    }

    function selecionarFormatoFinanceiro(formato) {
      const radios = document.querySelectorAll('input[name="formatoFinanceiro"]');
      radios.forEach(radio => {
        radio.checked = radio.value === formato;
        radio.parentElement.style.borderColor = radio.checked ? '#018820' : '#e0e0e0';
        radio.parentElement.style.background = radio.checked ? '#f0fdf4' : 'white';
      });
    }

    async function gerarRelatorioFinanceiro() {
      const tipo = document.getElementById('tipoRelatorioFinanceiro').value;
      const periodo = document.getElementById('periodoRelatorioFinanceiro').value;
      const formato = document.querySelector('input[name="formatoFinanceiro"]:checked').value;

      try {
        console.log('ğŸ“Š Gerando relatÃ³rio financeiro:', { tipo, periodo, formato });

        // Simular geraÃ§Ã£o
        await new Promise(resolve => setTimeout(resolve, 2000));

        alert(`âœ… RelatÃ³rio financeiro gerado!\n\nğŸ“‹ Tipo: ${tipo}\nğŸ“… PerÃ­odo: ${periodo}\nğŸ“„ Formato: ${formato.toUpperCase()}\n\nO download iniciarÃ¡ automaticamente.`);

        fecharRelatorioFinanceiro();
      } catch (error) {
        alert('âŒ Erro ao gerar relatÃ³rio. Tente novamente.');
      }
    }

    // Adicionar conta bancÃ¡ria
    function adicionarContaBancaria() {
      const modal = document.createElement('div');
      modal.id = 'modalContaBancaria';
      modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
      `;

      modal.innerHTML = `
        <div style="background: white; border-radius: 12px; padding: 20px; width: 95%; max-width: 450px; max-height: 85vh; overflow-y: auto; margin: 20px;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2 style="margin: 0; color: #333; font-size: 18px;">ğŸ¦ Adicionar Conta BancÃ¡ria</h2>
            <button onclick="fecharModalContaBancaria()" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #666;">&times;</button>
          </div>

          <form id="formContaBancaria" onsubmit="salvarContaBancaria(event)">
            <div style="display: grid; gap: 20px;">

              <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">ğŸ¦ Banco</label>
                <select id="bancoInput" required style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px;">
                  <option value="">Selecione o banco</option>
                  <option value="001">Banco do Brasil</option>
                  <option value="341">ItaÃº</option>
                  <option value="033">Santander</option>
                  <option value="104">Caixa EconÃ´mica</option>
                  <option value="237">Bradesco</option>
                  <option value="260">Nu Pagamentos</option>
                </select>
              </div>

              <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">ğŸ¢ AgÃªncia</label>
                <input type="text" id="agenciaInput" required style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px;" placeholder="Ex: 1234-5">
              </div>

              <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">ğŸ’³ Conta</label>
                <input type="text" id="contaInput" required style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px;" placeholder="Ex: 67890-1">
              </div>

              <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">ğŸ“‹ Tipo de Conta</label>
                <select id="tipoContaInput" required style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px;">
                  <option value="corrente">Conta Corrente</option>
                  <option value="poupanca">Conta PoupanÃ§a</option>
                </select>
              </div>

            </div>

            <div style="display: flex; gap: 15px; margin-top: 30px;">
              <button type="button" onclick="fecharModalContaBancaria()" style="flex: 1; padding: 12px; background: #6b7280; color: white; border: none; border-radius: 8px; cursor: pointer;">
                Cancelar
              </button>
              <button type="submit" style="flex: 1; padding: 12px; background: #018820; color: white; border: none; border-radius: 8px; cursor: pointer;">
                ğŸ’¾ Salvar Conta
              </button>
            </div>
          </form>
        </div>
      `;

      document.body.appendChild(modal);
    }

    function fecharModalContaBancaria() {
      const modal = document.getElementById('modalContaBancaria');
      if (modal) modal.remove();
    }

    async function salvarContaBancaria(event) {
      event.preventDefault();

      const formData = {
        banco: document.getElementById('bancoInput').value,
        agencia: document.getElementById('agenciaInput').value,
        conta: document.getElementById('contaInput').value,
        tipo: document.getElementById('tipoContaInput').value
      };

      try {
        console.log('ğŸ’¾ Salvando conta bancÃ¡ria:', formData);
        await new Promise(resolve => setTimeout(resolve, 1000));

        alert('âœ… Conta bancÃ¡ria adicionada com sucesso!');
        fecharModalContaBancaria();
        location.reload();
      } catch (error) {
        alert('âŒ Erro ao adicionar conta. Tente novamente.');
      }
    }

    // Adicionar mÃ©todo de transferÃªncia
    function adicionarMetodoTransferencia() {
      const modal = document.createElement('div');
      modal.id = 'modalMetodoTransferencia';
      modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
      `;

      modal.innerHTML = `
        <div style="background: white; border-radius: 12px; padding: 20px; width: 95%; max-width: 450px; max-height: 85vh; overflow-y: auto; margin: 20px;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2 style="margin: 0; color: #333; font-size: 18px;">ğŸ¦ Adicionar MÃ©todo de TransferÃªncia</h2>
            <button onclick="fecharModalMetodoTransferencia()" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #666;">&times;</button>
          </div>

          <form onsubmit="salvarMetodoTransferencia(event)">
            <div style="display: grid; gap: 15px;">

              <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">ğŸ’³ Tipo</label>
                <select id="tipoMetodo" required style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px;">
                  <option value="pix">PIX</option>
                  <option value="ted">TED</option>
                  <option value="doc">DOC</option>
                </select>
              </div>

              <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">ğŸ“ Chave/Dados</label>
                <input type="text" id="dadosMetodo" required style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px;" placeholder="Ex: email@exemplo.com">
              </div>

            </div>

            <div style="display: flex; gap: 15px; margin-top: 20px;">
              <button type="button" onclick="fecharModalMetodoTransferencia()" style="flex: 1; padding: 12px; background: #6b7280; color: white; border: none; border-radius: 8px; cursor: pointer;">
                Cancelar
              </button>
              <button type="submit" style="flex: 1; padding: 12px; background: #018820; color: white; border: none; border-radius: 8px; cursor: pointer;">
                ğŸ’¾ Salvar
              </button>
            </div>
          </form>
        </div>
      `;

      document.body.appendChild(modal);
    }

    function fecharModalMetodoTransferencia() {
      const modal = document.getElementById('modalMetodoTransferencia');
      if (modal) modal.remove();
    }

    function salvarMetodoTransferencia(event) {
      event.preventDefault();
      alert('âœ… MÃ©todo de transferÃªncia adicionado com sucesso!');
      fecharModalMetodoTransferencia();
    }

    // Adicionar link de pagamento
    function adicionarLinkPagamento() {
      const modal = document.createElement('div');
      modal.id = 'modalLinkPagamento';
      modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
      `;

      modal.innerHTML = `
        <div style="background: white; border-radius: 12px; padding: 20px; width: 95%; max-width: 450px; max-height: 85vh; overflow-y: auto; margin: 20px;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2 style="margin: 0; color: #333; font-size: 18px;">ğŸ”— Adicionar Link de Pagamento</h2>
            <button onclick="fecharModalLinkPagamento()" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #666;">&times;</button>
          </div>

          <form onsubmit="salvarLinkPagamento(event)">
            <div style="display: grid; gap: 15px;">

              <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">ğŸ¢ Gateway</label>
                <select id="gatewayPagamento" required style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px;">
                  <option value="mercadopago">Mercado Pago</option>
                  <option value="pagseguro">PagSeguro</option>
                  <option value="paypal">PayPal</option>
                  <option value="stripe">Stripe</option>
                </select>
              </div>

              <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">ğŸ”‘ Token/Chave API</label>
                <input type="text" id="tokenApi" required style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px;" placeholder="Cole aqui sua chave API">
              </div>

              <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">ğŸ’° Taxa (%)</label>
                <input type="number" id="taxaGateway" step="0.01" min="0" max="100" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px;" placeholder="Ex: 4.99">
              </div>

            </div>

            <div style="display: flex; gap: 15px; margin-top: 20px;">
              <button type="button" onclick="fecharModalLinkPagamento()" style="flex: 1; padding: 12px; background: #6b7280; color: white; border: none; border-radius: 8px; cursor: pointer;">
                Cancelar
              </button>
              <button type="submit" style="flex: 1; padding: 12px; background: #018820; color: white; border: none; border-radius: 8px; cursor: pointer;">
                ğŸ’¾ Salvar
              </button>
            </div>
          </form>
        </div>
      `;

      document.body.appendChild(modal);
    }

    function fecharModalLinkPagamento() {
      const modal = document.getElementById('modalLinkPagamento');
      if (modal) modal.remove();
    }

    function salvarLinkPagamento(event) {
      event.preventDefault();
      alert('âœ… Gateway de pagamento configurado com sucesso!');
      fecharModalLinkPagamento();
    }

    // Editar informaÃ§Ãµes pessoais
    function editarInformacoesPessoais() {
      const modal = document.createElement('div');
      modal.id = 'modalEditarPerfil';
      modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
      `;

      modal.innerHTML = `
        <div style="background: white; border-radius: 12px; padding: 20px; width: 95%; max-width: 500px; max-height: 85vh; overflow-y: auto; margin: 20px;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2 style="margin: 0; color: #333; font-size: 18px;">âœï¸ Editar InformaÃ§Ãµes Pessoais</h2>
            <button onclick="fecharModalEditarPerfil()" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #666;">&times;</button>
          </div>

          <form onsubmit="salvarEdicaoPerfil(event)">
            <div style="display: grid; gap: 15px;">

              <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">ğŸ‘¤ Nome Completo</label>
                <input type="text" id="nomeCompleto" required style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px;" value="<%= usuario.nome %>">
              </div>

              <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">ğŸ“§ Email</label>
                <input type="email" id="emailUsuario" required style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px;" value="<%= usuario.email %>">
              </div>

              <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">ğŸ“± Telefone</label>
                <input type="tel" id="telefoneUsuario" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px;" value="<%= usuario.telefone || '' %>" placeholder="(11) 99999-9999">
              </div>

              <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">ğŸ“„ CPF/CNPJ</label>
                <input type="text" id="documentoUsuario" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px;" value="<%= usuario.documento || '' %>" placeholder="000.000.000-00">
              </div>

            </div>

            <div style="display: flex; gap: 15px; margin-top: 20px;">
              <button type="button" onclick="fecharModalEditarPerfil()" style="flex: 1; padding: 12px; background: #6b7280; color: white; border: none; border-radius: 8px; cursor: pointer;">
                Cancelar
              </button>
              <button type="submit" style="flex: 1; padding: 12px; background: #018820; color: white; border: none; border-radius: 8px; cursor: pointer;">
                ğŸ’¾ Salvar
              </button>
            </div>
          </form>
        </div>
      `;

      document.body.appendChild(modal);
    }

    function fecharModalEditarPerfil() {
      const modal = document.getElementById('modalEditarPerfil');
      if (modal) modal.remove();
    }

    function salvarEdicaoPerfil(event) {
      event.preventDefault();
      alert('âœ… InformaÃ§Ãµes pessoais atualizadas com sucesso!');
      fecharModalEditarPerfil();
      location.reload();
    }

    // Salvar alteraÃ§Ãµes
    function salvarAlteracoes() {
      alert('ğŸ’¾ Salvando alteraÃ§Ãµes...\n\nTodas as informaÃ§Ãµes foram atualizadas com sucesso!');
    }

    // Alterar senha
    function alterarSenha() {
      const modal = document.createElement('div');
      modal.id = 'modalAlterarSenha';
      modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
      `;

      modal.innerHTML = `
        <div style="background: white; border-radius: 12px; padding: 20px; width: 95%; max-width: 450px; max-height: 85vh; overflow-y: auto; margin: 20px;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2 style="margin: 0; color: #333; font-size: 18px;">ğŸ”’ Alterar Senha</h2>
            <button onclick="fecharModalAlterarSenha()" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #666;">&times;</button>
          </div>

          <form id="formAlterarSenha" onsubmit="salvarNovaSenha(event)">
            <div style="display: grid; gap: 20px;">

              <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">ğŸ” Senha Atual</label>
                <input type="password" id="senhaAtualInput" required style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px;" placeholder="Digite sua senha atual">
              </div>

              <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">ğŸ†• Nova Senha</label>
                <input type="password" id="novaSenhaInput" required minlength="6" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px;" placeholder="Digite a nova senha">
              </div>

              <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">âœ… Confirmar Nova Senha</label>
                <input type="password" id="confirmarSenhaInput" required minlength="6" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px;" placeholder="Confirme a nova senha">
              </div>

              <div style="background: #f0f9ff; padding: 15px; border-radius: 8px; border: 2px solid #3b82f6;">
                <div style="font-weight: 600; color: #333; margin-bottom: 5px;">ğŸ›¡ï¸ Requisitos de SeguranÃ§a:</div>
                <div style="color: #666; font-size: 14px;">
                  â€¢ MÃ­nimo 6 caracteres<br>
                  â€¢ Recomendado: letras, nÃºmeros e sÃ­mbolos
                </div>
              </div>

            </div>

            <div style="display: flex; gap: 15px; margin-top: 30px;">
              <button type="button" onclick="fecharModalAlterarSenha()" style="flex: 1; padding: 12px; background: #6b7280; color: white; border: none; border-radius: 8px; cursor: pointer;">
                Cancelar
              </button>
              <button type="submit" style="flex: 1; padding: 12px; background: #018820; color: white; border: none; border-radius: 8px; cursor: pointer;">
                ğŸ”’ Alterar Senha
              </button>
            </div>
          </form>
        </div>
      `;

      document.body.appendChild(modal);
    }

    function fecharModalAlterarSenha() {
      const modal = document.getElementById('modalAlterarSenha');
      if (modal) modal.remove();
    }

    async function salvarNovaSenha(event) {
      event.preventDefault();

      const senhaAtual = document.getElementById('senhaAtualInput').value;
      const novaSenha = document.getElementById('novaSenhaInput').value;
      const confirmarSenha = document.getElementById('confirmarSenhaInput').value;

      if (novaSenha !== confirmarSenha) {
        alert('âŒ As senhas nÃ£o coincidem. Tente novamente.');
        return;
      }

      try {
        console.log('ğŸ”’ Alterando senha...');
        await new Promise(resolve => setTimeout(resolve, 1500));

        alert('âœ… Senha alterada com sucesso!\n\nPor seguranÃ§a, vocÃª serÃ¡ redirecionado para fazer login novamente.');
        fecharModalAlterarSenha();

        // Simular logout
        setTimeout(() => {
          window.location.href = '/login';
        }, 2000);
      } catch (error) {
        alert('âŒ Erro ao alterar senha. Tente novamente.');
      }
    }

    // Baixar dados
    function baixarDados() {
      alert('ğŸ“„ Preparando download dos seus dados...\n\nEm breve vocÃª receberÃ¡ um arquivo ZIP com:\nâ€¢ Dados pessoais\nâ€¢ HistÃ³rico de vendas\nâ€¢ RelatÃ³rios financeiros\nâ€¢ ConfiguraÃ§Ãµes da conta');

      setTimeout(() => {
        alert('âœ… Download iniciado!\n\nVerifique sua pasta de downloads.');
      }, 3000);
    }

    console.log('ğŸ‘¤ PÃ¡gina de perfil carregada com funcionalidades completas');
  </script>
</body>
</html>
